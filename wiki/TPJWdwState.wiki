#summary TPJWdwState class description
<wiki:comment>
$Rev$
$Date$
</wiki:comment>

= TPJWdwState =

*Project:* [WindowStateComponents Window State Components].

*Unit:* _PJWdwState_.

This non-visual component enables the size, position and state of the form on which it is placed to be saved to and read from an ini file.

The _[TPJWdwStateSave Save]_ method saves the window information to a section of an ini file and the _[TPJWdwStateRestore Restore]_ method reads information in and sets the owning form window's size, position and state.

The component's _[TPJCustomWdwStateAutoSaveRestore AutoSaveRestore]_ property governs whether window sizes, positions and states are automatically restored on opening and saved on closing or whether the user must explicitly call the _Save_ and _Restore_ methods. 

The _[TPJCustomWdwStateOptions Options]_ property and the _[TPJCustomWdwStateOnReadWdwState OnReadWdwState]_ event can be used to customise how the stored data is interpreted and whether the window's saved state or size should be used or ignored.

The ini file to be used is specified using the _[TPJWdwStateIniFileName IniFileName]_ property and the name of the section of the ini file to be used is given by the _[TPJWdwStateSection Section]_ property. Alternatively the _[TPJWdwStateOnGetIniData OnGetIniData]_ event can be handled and used to set the required ini file name and section.

It is only possible to have one instance of a _TPJWdwState_ component on any one form. Neither can a _TPJWdwState_ component be dropped onto a form that already contains either a _[TPJRegWdwState TPJRegWdwState]_ or a _[TPJUserWdwState TPJUserWdwState]_ component.

_TPJWdwState_ exposes the following methods, properties and events, some of which are inherited unchanged from _[TPJCustomWdwState TPJCustomWdwState]_.

== Methods ==

|| *Method* || *Description* ||
|| _[TPJCustomWdwStateCreate Create]_ || Class constructor that permits only one instance of the component to be placed on a form. ||
|| _[TPJCustomWdwStateCreateStandAlone CreateStandAlone]_ || Class constructor for use when creating components at run time. ||
|| _[TPJWdwStateReadWdwState ReadWdwState]_ || Overridden method that reads a window's size, position and state from an ini file. ||
|| _[TPJWdwStateRestore Restore]_ || Restores the size, position and state of a window from an ini file. ||
|| _[TPJWdwStateSave Save]_ || Saves the size, position and state of the window to an ini file. ||
|| _[TPJWdwStateSaveWdwState SaveWdwState]_ || Overridden method that writes a window's size, position and state to an ini file. ||


== Properties ==

|| *Property* || *Description* ||
|| _[TPJCustomWdwStateAutoSaveRestore AutoSaveRestore]_ || Determines whether the window's size, position and state is automatically restored on creation and stored on destruction. ||
|| _[TPJCustomWdwStateIgnoreState IgnoreState]_ || Determines whether the window's saved state (maximised, normal or minimised) is applied on restoration. This property is deprecated - use the _[TPJCustomWdwStateOptions Options]_ property instead. ||
|| _[TPJWdwStateIniFileName IniFileName]_ || Determines the name of the ini file used to record window information. ||
|| _[TPJCustomWdwStateMinimizeDelay MinimizeDelay]_ || Sets the delay between displaying a normalised form on screen and minimising it if required. ||
|| _[TPJCustomWdwStateOptions Options]_ || Determines how the component interprets the window display data read from storage. ||
|| _[TPJWdwStateSection Section]_ || Specifies the name of the section within an ini file to be used to store window information. ||

== Events ==

|| *Event* || *Description* ||
|| _[TPJWdwStateOnGetIniData OnGetIniData]_ || Event that allows user to change the name of the ini file and the section within it where window information is stored. ||
|| _[TPJCustomWdwStateOnReadWdwState OnReadWdwState]_ || Event that allows user to change the window data read from storage before the window is displayed. _TPJWdwState_ publishes this inherited protected event. ||
