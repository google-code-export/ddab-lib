#summary TPJOSInfo class description
<wiki:comment>
$Rev$
$Date$
</wiki:comment>

= TPJOSInfo =

*Project:* [SystemInformationUnit System Information Unit].

*Unit:* _PJSysInfo_.

This is a static class that gives access to information about the operating system on which the program is running. All the class' functionality is exposed through its static methods. Because it is static the class does not need to be instantiated before use.

When the host program is run in compatible many of _TPJOSInfo_'s methods will return information about the emulated operating system.

== Changes in v5.0 ==

With the introduction of Windows 8.1 Microsoft have deprecated the _!GetVersion_ and _!GetVersionEx_ API functions, which _TPJOSInfo_ uses to get version information. These API functions always return information about the reported operating, which, when the program is running in compatibility mode, may be different to the true operating system.

Therefore, from version 5, by default, the class uses a different approach to obtain version information when running on Windows Vista or later. This new method always returns information about the true operating system, regardless of any compatibility mode.

These changes mean that _TPSOSInfo_'s methods are affected by compatibility mode when run on operatinf systems prior to Windows Vista, but will ignore compatibility mode on Windows Vista and later.

To help decide if compatibility mode will affect the returned information check the value returned from _[TPJOSInfoCanSpoof TPJOSInfo.CanSpoof]_ [v5.0]: `True` is returned if compatibility mode has an effect on the class and `False` is returned if not.

_It is unfortunate that the class's behaviour is no longer consistent across operating systems, but there is no choice if the code is to abide by Microsoft's much criticised decision to deprecate and possibly remove the old API._

It is possible to compile _PJSysInfo_ so that it reverts to its former behaviour, but that means the deprecated API will be used. To do this comment out the `IGNORE_OS_SPOOFING_FROM_VISTA_UP` define.

_PJSysInfo_ can also be compiled to use the old _!GetVersion_ API functions on all operating systems prior to Windows 8.1. To do this comment out `IGNORE_OS_SPOOFING_FROM_VISTA_UP` and uncomment the `IGNORE_OS_SPOOFING_FROM_VISTA_UP` define.

v5.0 also provides some [TPJOSInfoIsReallyWindowsMethods new methods] to use to detect operating systems that always ignore compatibility mode.

== Methods ==

|| *Method* || *Description* ||
|| _[TPJOSInfoBuildNumber BuildNumber]_ || Gets the operating system build number. ||
|| _[TPJOSInfoCanSpoof CanSpoof]_ [v5.0] || Checks if the OS can be "spoofed" by specifying a compatibility mode for the program. ||
|| _[TPJOSInfoDescription Description]_ || Gets a full information about of an operating system version. ||
|| _[TPJOSInfoEdition Edition]_ || Gets the edition of an operating system product. ||
|| _[TPJOSInfoHasPenExtensions HasPenExtensions]_ || Checks for Windows Pen Extensions. ||
|| _[TPJOSInfoInstallationDate InstallationDate]_ || Gets the date that Windows was installed. ||
|| _[TPJOSInfoIsMediaCenter IsMediaCenter]_ || Checks for Windows Media Center. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows2000OrGreater]_ [v5.0] || Checks whether the OS is Windows 2000 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows2000SP1OrGreater]_ [v5.0] || Checks whether the OS is Windows 2000 Service Pack 1 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows2000SP2OrGreater]_ [v5.0] || Checks whether the OS is Windows 2000 Service Pack 2 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows2000SP3OrGreater]_ [v5.0] || Checks whether the OS is Windows 2000 Service Pack 3 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows2000SP4OrGreater]_ [v5.0] || Checks whether the OS is Windows 2000 Service Pack 4 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows7OrGreater]_ [v5.0]|| Checks whether the OS is Windows 7 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows7SP1OrGreater]_ [v5.0] || Checks whether the OS is Windows 7 Service Pack 1 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows8OrGreater]_ [v5.0] || Checks whether the OS is Windows 8 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindows8Point1OrGreater]_ [v5.0] || Checks whether the OS is Windows 8.1 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsVistaOrGreater]_ [v5.0] || Checks whether the OS is Windows Vista or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsVistaSP1OrGreater]_ [v5.0] || Checks whether the OS is Windows Vista Service Pack 1 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsVistaSP2OrGreater]_ [v5.0] || Checks whether the OS is Windows Vista Service Pack 2 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsXPOrGreater]_ [v5.0] || Checks whether the OS is Windows XP or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsXPSP1OrGreater]_ [v5.0] || Checks whether the OS is Windows XP Service Pack 1 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsXPSP2OrGreater]_ [v5.0] || Checks whether the OS is Windows XP Service Pack 2 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsReallyWindowsMethods IsReallyWindowsXPSP3OrGreater]_ [v5.0] || Checks whether the OS is Windows XP Service Pack 3 or greater. Ignores compatibility mode. ||
|| _[TPJOSInfoIsRemoteSession IsRemoteSession]_ [v3.3] || Checks for a Windows Terminal Server remote session. ||
|| _[TPJOSInfoIsServer IsServer]_ || Checks for a server operating system. ||
|| _[TPJOSInfoIsTabletPC IsTabletPC]_ || Checks for Windows Tablet PC. ||
|| _[TPJOSInfoIsWin32s IsWin32s]_ || Checks for the Windows 32s system. ||
|| _[TPJOSInfoIsWin9x IsWin9x]_ || Checks for the Windows 95 platform. ||
|| _[TPJOSInfoIsWindowsServer IsWindowsServer]_ [v5.0] || Checks if the OS is a server version. (When run in compatibility mode on Windows 2000 and later this method returns the true OS, unlike _[TPJOSInfoIsServer IsServer]_). ||
|| _[TPJOSInfoIsWinNT IsWinNT]_ || Checks for the Windows NT platform. ||
|| _[TPJOSInfoIsWow64 IsWow64]_ || Checks if the program is running on WOW64. ||
|| _[TPJOSInfoMajorVersion MajorVersion]_ || Gets the operating system major version. ||
|| _[TPJOSInfoMinorVersion MinorVersion]_ || Gets the operating system minor version. ||
|| _[TPJOSInfoPlatform Platform]_ || Gets the operating system platform. ||
|| _[TPJOSInfoProduct Product]_ || Gets a code representing the operating system product. ||
|| _[TPJOSInfoProductID ProductID]_ || Gets the Windows product ID. ||
|| _[TPJOSInfoProductName ProductName]_ || Gets the name of the operating system product. ||
|| _[TPJOSInfoRegisteredOrganisation RegisteredOrganisation]_ [v4.0] || Gets the name of the organisation to which Windows is registered. ||
|| _[TPJOSInfoRegisteredOwner RegisteredOwner]_ [v4.0] || Gets the name of the person owning this copy of Windows. ||
|| _[TPJOSInfoServicePack ServicePack]_ || Gets the operating system's service pack. ||
|| _[TPJOSInfoServicePackMajor ServicePackMajor]_ || Gets the operating system's major service pack version number. ||
|| _[TPJOSInfoServicePackMinor ServicePackMinor]_ || Gets the operating system's minor service pack version number. ||

== Properties ==

_TPJOSInfo_ defines no properties.

== Events ==

_TPJOSInfo_ defines no events.