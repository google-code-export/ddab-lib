<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

	<title>
		DelphiDabbler.com Info Sheet: Console Application Runner Classes
	</title>

	<style type="text/css">
		<!--
		body {
			margin: 1em;
			padding: 0;
			font-family: Verdana, Arial, sans-serif;
			font-size: 9pt;
			line-height: 150%;
		}
		h1 {
			margin: 0 0 1em 0;
			padding: 0.5em;
			border: 1px silver solid;
			background-color: #eee;
			font-size: 13pt;
			font-weight: bold;
			text-align: center;
		}
		h1 .subtitle {
			font-style: italic;
			color: #336;
		}
		h2 {
			margin: 1em 0 0 0;
			padding: 0;
			padding-bottom: 6px;
			border-bottom: 1px silver solid;
			font-size: 11pt;
			font-weight: bold;
		}
		h3 {
			margin: 0.5em 0 0 0;
			padding: 0;
			font-size: 9pt;
			font-weight: bold;
		}
		p {
			margin: 0.5em 0 0 0;
			padding: 0;
		}
		ul, ol {
			margin: 0.5em 0 0 3em;
			padding: 0;
		}
		ul {
			list-style-type: square;
		}
		ul.spaced li,
		ol.spaced li {
			margin-top: 0.5em;
		}
		ul.spaced li,
		ol.spaced li {
			margin-top: 0.5em;
		}
		ul.unspaced li,
		ol.unspaced li {
			margin-top: 0;
		}
		ul.unspaced li.first,
		ol.unspaced li.first {
			margin-top: 0.5em;
		}
		code {
			font-family: "Courier New", Courier, monospace;
		}
		a:link {
			color: #336;
			text-decoration: underline;
		}
		a:visited {
			color: #669;
			text-decoration: underline;
		}
		a:active {
			color: #336;
			text-decoration: underline;
		}
		a:hover {
			text-decoration: underline;
		}
		.gototop {
			margin: 1em 0 0 0;
			padding: 0.3em 0 0 0;
			text-align: center;
			position: relative;
			float: right;
			font-weight: bold;
		}
		.pullout {
			border-left: 8px silver solid;
			xborder-bottom: 2px silver solid;
			xborder-top: 2px silver solid;
			background-color: #eee;
			margin: 0.5em 0 0 0;
			padding: 0.25em 0.5em;
			font-style: italic;
		}
		.indent {
			margin-left: 3em;
		}
		.highlight {
			color: #336;
			font-style: italic;
			font-weight: bold;
		}
		.endnotes {
			margin: 1.5em 0 0 0;
			padding: 1em 0 0 0;
			border-top: 1px silver solid;
		}
		.comments {
			font-style: italic;
		}
		.copyright,
		.copyright a:link,
		.copyright a:visited,
		.copyright a:active {
			margin: 1em 0 0 0;
			color: gray;
			font-size: 8pt;
			text-align: right;
		}
		-->
	</style>

</head>

<body>

<h1>
	Console Application Runner Classes<br />
	<span class="subtitle">Information Sheet</span>
</h1>


<h2 id="contents">
	Contents
</h2>

<ul>
	<li><a href="#overview">Overview</a></li>
	<li><a href="#compatibility">Compatibility</a></li>
	<li><a href="#installation">Installation</a></li>
	<li><a href="#changelog">Change log</a></li>
	<li><a href="#license">License</a></li>
	<li><a href="#author">About the Author</a></li>
</ul>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="overview">
	Overview
</h2>

<p>
	Theses class are designed to be used to control the execution of child
	console application processes and to redirect input and output where
	required.
</p>

<p>
	The main class &ndash; <var>TPJConsoleApp</var> &ndash; will run console
	applications. It enables the console application's standard input, standard
	output and standard error to be redirected to and from files or pipes.
</p>

<p>
	The class can also timeslice the running of the console application to
	enable the calling application to continue processing and to enable
	redirected piped output to be processed.
</p>

<p>
	Various other properties of the console application can also be configured,
	including:
</p>

<ul>
	<li>
		Whether the application's process and thread handles can be inherited.
	</li>
	<li>
		Whether the application is visible or is displayed in a new console
		window.
	</li>
	<li>
		The console window's title.
	</li>
	<li>
		The environment block passed to the application.
	</li>
	<li>
		The application's maximum execution time. The process can be forcibly
		terminated if it times-out.
	</li>
	<li>
		The application's priority.
	</li>
</ul>	

<p>
	If the class fails to execute the application it sets an <var>ExitCode</var>
	and an <var>ErrorMessage</var> property. The exit code of the application is
	returned via the <var>ExitCode</var> property. Errant applications can be
	terminated.
</p>

<p>
	<var>TPJConsoleApp</var> descends from <var>TPJCustomConsoleApp</var>, which
	provides all the functionality of the derived class, except that all
	properties are protected. <var>TPJCustomConsoleApp</var> should be used if
	you need to create subclasses. Subclasses can make required properties
	public.
</p>

<p>
	<var>TPJPipe</var> is a helper class that assists in working with pipes used
	for redirecting input / output. This class simplifies reading and writing to
	pipes.
</p>

<p>
	The classes come with numerous demo programs that illustrate how to use the
	classes. See <code>DemoReadMe.htm</code> included in the <code>Demos</code>
	sub-directory.
</p>

<p>
	A comprehensive PDF user guide can be downloaded separately.
	<a
		href="http://www.delphidabbler.com/download?id=consoleapp&amp;type=docs"
	>Download the user guide</a>.
</p>

	
<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="compatibility">
   Compatibility
</h2>

<p>
	The Console Application Runner Classes have been developed and tested with
	Delphi 7. The classes are likely to work with later versions of Delphi and
	may work with earlier 32 bit versions.
</p>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="installation">
	Installation
</h2>

<p>
	The Console Application Runner Classes and associated documentation and demo
	programs are provided in a zip file. Before installing, or using, you need
	to extract all the files from the zip file, preserving the directory
	structure.
</p>

<p>
	The required units are <code>UPJConsoleApp.pas</code> and
	<code>UPJPipe.pas</code>. Once extracted you can use the units in various
	ways.
</p>

<ol class="spaced">
	<li>
		The simplest way is to add the required units to your projects as you
		need them.
	</li>
	<li>
		To make the units easier to re-use you can either copy them to a folder
		on your Delphi search path, or add the folder where you extracted the
		units to the Delphi Search path, and then simply use the units as
		required without needing to add them to your project.
	</li>
	<li>
		For maximum portability you can add the units to a Delphi desgin time
		package. The methods for Delphi 7 (and v3 to v6) and for Delphi 2005 or
		later are different and are explained below.
		<ul class="unspaced">
			<li class="first">
				<a href="#d7">Installation with Delphi 7 (and earlier)</a>
			</li>
			<li>
				<a href="#bds">Installation with Delphi 2005 and later</a>
			</li>
		</ul>
	</li>
</ol>


<h3 id="d7">
	Installation with Delphi 7 (and earlier)
</h3>

<p>
	Note that <code>$(DELPHI)</code> represents the path where the appropriate
	version of Delphi was installed.
</p>

<p>
	The classes may be installed into a design package. It is assumed that you
	will be installing into an existing package. You may wish to use the
	&quot;user&quot; package named <code>dclusr.dpk</code> or
	<code>dclusrXX.dpk</code> (where <code>XX</code> is a version number). This
	package can be found in <code>$(DELPHI)\Lib</code>. 
</p>


<ol class="spaced">
	<li>
		Decide upon a suitable location into which to install the classes. This
		may be a subdirectory of your <code>$(DELPHI)\lib</code> folder.
	</li>
	<li>
		Copy <code>PJConsoleApp.pas</code> and <code>PJPipe.pas</code> to the
		chosen installation folder.
	</li>
	<li>	
		Start Delphi then:
		<ul>
			<li>
				Choose the <em>Component | Install Component</em> menu option to
				display the <em>Install Component</em> dialog box. Ensure the
				<em>Into existing package</em> tab is selected. Enter the full
				path to <code>PJConsoleApp.pas</code> in the <em>Unit file
				name</em> edit box (use the adjacent <em>Browse</em> button to
				navigate to the file). Repeat this step for
				<code>PJPipe.pas</code>. Choose the required package from the
				<em>Package description</em> combo box, or by navigating to the
				package using <em>Browse</em>. Click <em>OK</em> to confirm your
				selections. 
			</li>
			<li>
				A confirmation dialog box may displayed, querying whether it is
				OK to rebuild and reinstall the package. Click <em>Yes</em> to
				proceed. The package will now be rebuilt.
			</li>
		</ul>
	</li>
	<li>
		If you wish you can now delete <code>PJConsoleApp.pas</code> and
		<code>PJPipe.pas</code> from the chosen installation folder.
	</li>
	<li>
		The various demo programs can be loaded into Delphi and compiled and run
		as required.
	</li>
</ol>


<h3 id="bds">
	Installation with Delphi 2005 and later
</h3>

<p>
	Note that <code>$(BDS)</code> represents the path where the appropriate
	version of the Borland Development System is installed.
</p>

<p>
	The classes may be installed into a Delphi Win32 design package. It is
	assumed that you will be installing into an existing package. You may decide
	to install into the &quot;user&quot; package:
	<code>$(BDS)\Lib\dclusr.dpk</code>.
</p>

<ol class="spaced">
	<li>
		Decide upon a suitable location into which to install the classes.
		This may be a subdirectory of your <code>Borland Studio Projects</code>
		or <code>$(BDS)\lib</code> folders.
	</li>
	<li>
		Copy <code>PJConsoleApp.pas</code> and <code>PJPipe.pas</code> to the
		chosen installation folder.
	</li>
	<li>
		Start the Development System (selecting the Delphi Win32 personality if
		appropriate) then:
		<ul>
			<li>
				Open the required package. Select <em>File | Open</em> menu and
				choose a suitable package source file.
			</li>
			<li>
				The package will now be displayed in the Project Manager with a
				<code>.bpl</code> extension. Right click the package's entry and
				select <em>Add</em> to display the <em>Add</em> dialog box.
				Enter the full path to <code>PJConsoleApp.pas</code> in the
				<em>Unit file name</em> edit box (use the <em>Browse</em> button
				to navigate to the file). Click <em>OK</em> to add the component
				to the package.
			</li>
			<li>
				If required repeat the previous step for
				<code>PJPipe.pas</code>.
			</li>
			<li>
				Back in the Project Manager, check that
				<code>PJConsoleApp.pas</code> and <code>PJPipe.pas</code> appear
				under the package's <em>Contains</em> node. If so, right click
				the package's entry again and select <em>Compile</em>.
			</li>
			<li>
				Close the package project using the <em>File | Close</em> menu
				item. Accept any prompt that offers to save the package project.
			</li>
		</ul>
	</li>
	<li>
		If you wish you can now delete <code>PJConsoleApp.pas</code> and, if
		used, <code>PJPipe.pas</code>, from the chosen installation folder.
	</li>
	<li>
		The various demo programs can be loaded into Delphi and compiled and run
		as required.
	</li>
</ol>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="changelog">
	Change log
</h2>

<p>
	A complete change log is provided in a text file that is included in the
	download.
</p>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="license">
	License
</h2>

<p>
	This product, <em>Console Application Runner Classes</em>, is subject to the
	Mozilla Public License Version 1.1 (the &quot;License&quot;). You may not
	use this Product except in compliance with the License. You may obtain a
	copy of the License at
	<a href="http://www.mozilla.org/MPL/">http://www.mozilla.org/MPL/</a>.
</p>

<p>
	Software distributed under the License is distributed on an &quot;AS
	IS&quot; basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See
	the License for the specific language governing rights and limitations under
	the License.
</p>

<p>
	The Initial Developer of <em>Console Application Runner Classes</em> is
	Peter D Johnson. Portions created by the Initial Developer are Copyright
	&copy; 2007-2008 Peter D Johnson (www.delphidabbler.com). All Rights
	Reserved.
</p>

<p>
	All relevant trademarks are acknowledged.
</p>


<p class="pullout">
	A copy of the license is included in the download &ndash see
	<code>MPL.txt</code>.
</p>

<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="author">
	About the Author
</h2>

<p>
	I'm Peter Johnson &ndash; a hobbyist programmer living in Ceredigion in West
	Wales,  UK, writing write mainly in Delphi. My programs are available for
	download from:
	<a href="http://www.delphidabbler.com/">http://www.delphidabbler.com/</a>.
</p>


<div class="endnotes">

	<div class="comments">
		Please
		<a href="http://www.delphidabbler.com/contact">
		let me know</a> if you have any comments about the components, if you
		have found a bug, or you want to suggest any updates.
	</div>

	<div class="copyright">
		This info sheet is copyright &copy; 2007-2008, P D Johnson,
		<a href="http://www.delphidabbler.com/">
		www.delphidabbler.com</a>
	</div>

</div>

</body>

</html>
